# 소켓

## 소켓이란?

OSI 7계층에서 프로그램 개발에서는 보통 애플리케이션 계층(7계층)을 건드린다. 하지만 UDP, TCP의 프로토콜로 구현되는 인터넷을 구현하기 위해서는 결국 전송계층(4계층)에 접근해야 한다. 이 때 애플리케이션 계층에서 트랜스포트 계층을 조작하는 방법이 바로 Socket이라고 불리는 인터페이스이다. UNIX에서 등장했으며, OS에서 제공하는 인터페이스이고, 어떤 종류의 프로그램이라 하더라도 이 소켓에 접근하여 외부 네트워크와 통신할 수 있다.

소켓은 프로토콜, IP 주소, 포트 넘버로 정의된다.

- 프로토콜

  프로토콜은 원래 외교상의 언어로써 의례나 국가간에 약속을 의미하며, 통신에서는 어떤 시스템이 다른 시스템과 통신을 원활하게 수용하도록 해주는 통신 규약, 약속을 의미한다.

- IP

  전 세계 컴퓨터에 부여된 고유의 식별주소

- 포트

  포트(Port)는 네트워크 상에서 통신하기 위해서 호스트 내부적으로 프로세스가 할당받아야 하는 고유한 숫자이다. 한 호스트 내에서 네트워크 통신을 하고 있는 프로세스를 식별하기 위해 사용되는 값이므로, 같은 호스트 내에서 서로 다른 프로세스가 같은 포트 넘버를 가질 수 없다. 즉, 같은 컴퓨터 내에서 프로그램을 식별하는 번호이다.

즉, 소켓은 떨어져 있는 두 호스트를 연결해주는 도구로써 인터페이스의 역할을 하는데 데이터를 주고 받을 수 있는 구조체로 소켓을 통해 데이터 통로가 만들어 진다. 이러한 소켓은 역할에 따라 서버 소켓, 클라이언트 소켓으로 구분된다.

## 소켓의 작동방식

소켓은 OS에서 제공하는 인터페이스이다. 소켓에 관련된 작업을 수행하면, OS는 그 요청을 받아들여서 새로운 소켓을 만들어주고, 우리는 오로지 이 소켓으로만 외부 네트워크로 통신이 가능하다.

![img](https://blog.kakaocdn.net/dn/PBVXO/btqPsCpWu3O/rhYf4R3U9KmJKEEJDX4Mkk/img.png)

### 서버 소켓

1) socket() : 클라이언트와 서버를 연결할 연결용 소켓을 생성한다.

2) bind() : IP와 Port 번호를 결합한다.

3) listen() : 클라이언트의 접근 요청을 수신하는 대기열을 만들어 몇 개의 클라이언트를 대기 시킬지 결정한다.

​        클라이언트가 connect() 해오기 전까지 대기하기 때문에 listen()은 별도 스레드를 만들어서 처리한다고 한다.

4) accept() : 새로운 소켓을 만들어 클라이언트와 실질적인 연결을 수행한다.

 

### 클라이언트 소켓

1) socket() : 소켓을 생성한다.

2) connect() : 통신할 서버에 설정된 ip와 port 번호에 통신을 시도한다.

3) 통신 시도 시, 서버가 accept() 함수로 클라이언트의 socket descriptor를 반환한다.

4) 이를 통해 클라이언트와 서버는 서로 send(), recv()하며 데이터를 송수신한다.

 

### 소켓 종류

#### 스트림 소켓(TCP)

- 양방향으로 바이트 스트림을 전송하며, 연결 지향성을 띤다.

- 오류수정, 전송처리, 흐름제어를 보장한다.

- 송신된 순서에 따라 중복되지 않게 데이터를 수신한다.

- TCP를 사용하여 소량의 데이터보다 대량의 데이터 전송에 적합하다.

 

#### 데이터그램 소켓(UDP

- 비연결형 소켓이다.

- 데이터의 크기에 제한이 있다.

- 전달이 확실하게 보장되지 않고, 데이터가 손실되어도 오류가 발생하지 않는다.

- 실시간 멀티미디어 정보를 처리하기 위해 주로 사용한다.

​			ex) 전화

 

### 소켓 통신의 특징

- 서버와 클라이언트가 특정 포트를 통해 실시간으로 **양방향 통신**을 하는 방식이다.

- 연결은 close()하기 전까지 유지된다.

- 실시간 데이터 송수신에 적합하다.

- 실시간 동영상 스트리밍이나 온라인 게임에 자주 사용된다.

### HTTP 통신과 SOCKET 통신의 비교

HTTP 통신

- Client의 요청(Request)이 있을 때만 서버가 응답(Response)하여 해당 정보를 전송하고 곧바로 연결을 종료하는 방식

HTTP통신의 특징

- Client가 요청을 보내는 경우에만 Server가 응답하는 단방향 통신이다.
- Server로부터 응답을 받은 후에는 연결이 바로 종료된다.
- 실시간 연결이 아니고, 필요한 경우에만 Server로 요청을 보내는 상황에 유용하다.
- 요청을 보내 Server의 응답을 기다리는 어플리케이션의 개발에 주로 사용된다.





---

출처 : [[기본\] 소켓(SOCKET)통신 이란? (tistory.com)](https://helloworld-88.tistory.com/215#:~:text=SOCKET 통신의 특징,경우에 자주 사용된다.)